ggtitle("Pregnant with PCOS") +
scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
scale_x_discrete(labels=c('No', 'Yes')) +
theme_ipsum() +
theme(
plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
)
pcos_data %>%
ggplot(aes(x=`Endometrium(mm)`, y=`Cycle_length(days)`, color=as.factor(PCOS))) +
geom_point() +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Endometrium(mm)", y = "Cycle Length(days)") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x=`Follicle_No(R)`, y=`Follicle_No(L)`, color=as.factor(PCOS))) +
geom_point() +
geom_smooth(method=lm, se=FALSE, color="red", fill="#69b3a2", se=TRUE) +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Follicles Right", y = "Follicles Left") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x=`Follicle_No(R)`, y=`Follicle_No(L)`, color=as.factor(PCOS))) +
geom_point() +
geom_smooth(method="lm", se=FALSE, color="red", fill="#69b3a2", se=TRUE) +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Follicles Right", y = "Follicles Left") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x=`Follicle_No(R)`, y=`Follicle_No(L)`, color=as.factor(PCOS))) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Follicles Right", y = "Follicles Left") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x=`Age(yrs)`, y=BMI, color=as.factor(PCOS))) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Age(yrs)", y = "BMI") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x=`Age(yrs)`, y=`Cycle(R/I)`, color=as.factor(PCOS))) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Age(yrs)", y = "Cycle(R/I)") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x=`Age(yrs)`, y=`Cycle_length(days)`, color=as.factor(PCOS))) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Age(yrs)", y = "Cycle Length(days)") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x=`Avg_F_size(R)(mm)`, y=`Avg_F_size(L)(mm)`, color=as.factor(PCOS))) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Follicle size right", y = "Follicle size left") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x=`Endometrium(mm)`, y=`Cycle_length(days)`, color=as.factor(PCOS))) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Endometrium(mm)", y = "Cycle Length(days)") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x = as.factor(Pregnant), fill = as.factor(PCOS))) +
geom_bar(position = "dodge") +
ggtitle("Pregnant with PCOS") +
scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
scale_x_discrete(labels=c('No', 'Yes')) +
theme_ipsum() +
theme(
plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
)
pcos_data %>%
ggplot(aes(x = No_of_abortions, fill = as.factor(PCOS))) +
geom_bar(position = "dodge") +
ggtitle("title") +
#scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
theme_ipsum() +
theme(
plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
)
pcos_data %>%
ggplot(aes(x = No_of_abortions, fill = as.factor(PCOS))) +
geom_bar(position = "dodge") +
ggtitle("title") +
scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
theme_ipsum() +
theme(
plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
)
pcos_data %>%
ggplot(aes(x = as.factor(`PRG(ng/mL)`))) +
geom_histogram(stat="count", show.legend = FALSE, , fill = "#69b3a2", color = "#e9ecef", alpha=0.9) +
labs(title="PRG range", x ="PRG(ng/mL)", y = "count") +
theme_ipsum() +
theme(
plot.title = element_text(size=10), axis.text.x = element_text(angle = 90, vjust = 1, hjust=2, size=5)
)
DataExplorer::plot_histogram(
geom_histogram_args = list(alpha = 0.5, fill = "purple"),
data = pcos_infertility,
ggtheme=theme_ipsum())
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(corrplot)
library(DataExplorer)
library(hrbrthemes)
library(ggplot2)
library(plotly)
library(gridExtra)
pcos <- read.csv("https://raw.githubusercontent.com/letisalba/DATA_608/master/Final%20Project/csv/PCOS_infertility.csv")
pcos_infertility <- read.csv("https://raw.githubusercontent.com/letisalba/DATA_608/master/Final%20Project/csv/PCOSData_without_infertility.csv")
head(pcos, 4)
head(pcos_infertility, 4)
glimpse(pcos)
glimpse(pcos_infertility)
DataExplorer::plot_histogram(
geom_histogram_args = list(alpha = 0.5, fill = "red"),
data = pcos,
ggtheme=theme_ipsum())
DataExplorer::plot_histogram(
geom_histogram_args = list(alpha = 0.5, fill = "purple"),
data = pcos_infertility,
ggtheme=theme_ipsum())
pcos <- mutate_all(pcos, function(x) as.numeric(as.character(x)))
pcos_infertility <- mutate_all(pcos_infertility, function(x) as.numeric(as.character(x)))
colnames(pcos)
colnames(pcos_infertility)
# removing first two column for `pcos` data
# pcos <- dplyr::select(pcos, -c(1:2))
pcos <- dplyr::select(pcos, -c(2))
# renaming columns for `pcos` data
pcos <- pcos %>%
rename("Sl.No" = "Sl..No",
"PCOS" = "PCOS..Y.N.",
"Ibeta-HCG(mIU/mL)" = "I...beta.HCG.mIU.mL.",
"IIbeta-HCG(mIU/mL)" = "II....beta.HCG.mIU.mL.",
"AMH(ng/mL)" = "AMH.ng.mL." )
# removing columns not needed for `pcos_infertility` data
#pcos_infertility <- dplyr::select(pcos_infertility, -c(1:2, 17:18, 26, 45))
pcos_infertility <- dplyr::select(pcos_infertility, -c(2:3, 17:18, 26, 45))
# renaming columns for `pcos_infertility` data
pcos_infertility <- pcos_infertility %>%
rename("Sl.No" = "Sl..No",
"Age(yrs)" = "Age..yrs.",
"Weight(kg)" = "Weight..Kg.",
"Height(cm)" = "Height.Cm.",
"Blood_Group" = "Blood.Group",
"Pulse rate(bpm)" = "Pulse.rate.bpm.",
"RR(breaths/min)" = "RR..breaths.min.",
"Hb(g/dl)" = "Hb.g.dl.",
"Cycle(R/I)" = "Cycle.R.I.",
"Cycle_length(days)" = "Cycle.length.days.",
"Marriage_Status(yrs)" = "Marraige.Status..Yrs.",
"Pregnant" = "Pregnant.Y.N.",
"No_of_abortions" = "No..of.aborptions",
"FSH(mIU/mL)" = "FSH.mIU.mL.",
"LH(mIU/mL)" = "LH.mIU.mL.",
"FSH-LH" = "FSH.LH",
"Hip(in)" = "Hip.inch.",
"Waist(in)" = "Waist.inch.",
"Waist-Hip_Ratio" = "Waist.Hip.Ratio",
"TSH (mIU/L)" = "TSH..mIU.L.",
"PRL(ng/mL)" = "PRL.ng.mL.",
"Vit_D3(ng/mL)" = "Vit.D3..ng.mL.",
"PRG(ng/mL)" = "PRG.ng.mL.",
"RBS(mg/dl)" = "RBS.mg.dl.",
"Weight_gain" = "Weight.gain.Y.N.",
"hair_growth" = "hair.growth.Y.N.",
"Skin_darkening" = "Skin.darkening..Y.N.",
"Hair_loss" = "Hair.loss.Y.N.",
"Pimples" = "Pimples.Y.N.",
"Fast_food" = "Fast.food..Y.N.",
"Reg_Exercise" = "Reg.Exercise.Y.N.",
"BP_Systolic(mmHg)" = "BP._Systolic..mmHg.",
"BP_Diastolic(mmHg)" = "BP._Diastolic..mmHg.",
"Follicle_No(L)" = "Follicle.No...L.",
"Follicle_No(R)" = "Follicle.No...R.",
"Avg_F_size(L)(mm)" = "Avg..F.size..L...mm.",
"Avg_F_size(R)(mm)" = "Avg..F.size..R...mm.",
"Endometrium(mm)" = "Endometrium..mm.")
# merge data sets
pcos_data <- merge(pcos, pcos_infertility,  by=c("Sl.No"))
head(pcos_data)
# missing data
colSums(is.na(pcos_data))
# convert Height from cm to m
pcos_data$"Height(cm)" <- round((pcos_data$"Height(cm)" * 0.01),1)
pcos_data <- pcos_data %>%
rename("Height(m)" = "Height(cm)")
# calculate BMI
pcos_data$BMI <- round((pcos_data$"Weight(kg)" / pcos_data$"Height(m)"^2), 1)
# calculate waist-hip ratio
pcos_data$"Waist-Hip_Ratio" <- round((pcos_data$"Waist(in)" / pcos_data$"Hip(in)"),2)
# calculate FSH/LH
pcos_data$"FSH-LH" <- round((pcos_data$"FSH(mIU/mL)"/pcos_data$"LH(mIU/mL)"),2)
# calculate Marriage Status
pcos_data$"Marriage_Status(yrs)"[is.na(pcos_data$"Marriage_Status(yrs)")] <- median(pcos_data$"Marriage_Status(yrs)", na.rm = T)
# calculate Fast food
pcos_data$"Fast_food"[is.na(pcos_data$"Fast_food")] <- median(pcos_data$"Fast_food", na.rm = T)
# calculate
pcos_data$"AMH(ng/mL)"[is.na(pcos_data$"AMH(ng/mL)")] <- median(pcos_data$"AMH(ng/mL)", na.rm = T)
DataExplorer::plot_histogram(
geom_histogram_args = list(alpha = 0.5, fill = "dark green"),
data = pcos_data,
ggtheme=theme_ipsum())
#DataExplorer::create_report(pcos_data, output_file='pcos_data.html')
ggplot(pcos_data, aes(x=pcos_data$'Age(yrs)', y=pcos_data$'Weight(kg)')) +
geom_point() +
labs(title="Scatterplot of Age(yrs) with Weight(kg)",
x ="Age(yrs)", y = "Weight(kg)") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
p1 <- pcos_data %>%
ggplot(aes(x = as.factor(PCOS), fill = as.factor(PCOS))) +
geom_bar(show.legend = FALSE) +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
scale_x_discrete(labels=c('No', 'Yes')) +
labs(title="PCOS(Y/N)", x ="PCOS(Yes or No)", y = "count") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
p2 <- pcos_data %>%
ggplot(aes(x = as.factor(Pregnant), fill = as.factor(Pregnant))) +
geom_bar(show.legend = FALSE) +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
scale_x_discrete(labels=c('No', 'Yes')) +
labs(title="Pregnant(Y/N)", x ="Pregnant(Yes or No)", y = "count") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
p3 <- pcos_data %>%
ggplot(aes(x = as.factor(Weight_gain), fill = as.factor(Weight_gain))) +
geom_bar(show.legend = FALSE) +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
scale_x_discrete(labels=c('No', 'Yes')) +
labs(title="Weight Gain(Y/N)", x ="Weight Gain (Yes or No)", y = "count") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
p4 <- pcos_data %>%
ggplot(aes(x = as.factor(hair_growth), fill = as.factor(hair_growth))) +
geom_bar(show.legend = FALSE) +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
scale_x_discrete(labels=c('No', 'Yes')) +
labs(title="Hair Growth(Y/N)", x ="Hair Growth(Yes or No)", y = "count") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
p5 <- pcos_data %>%
ggplot(aes(x = as.factor(Skin_darkening), fill = as.factor(Skin_darkening))) +
geom_bar(show.legend = FALSE) +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
scale_x_discrete(labels=c('No', 'Yes')) +
labs(title="Skin Darkening(Y/N)", x ="Skin Darkening (Yes or No)", y = "count") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
p6 <- pcos_data %>%
ggplot(aes(x = as.factor(Hair_loss), fill = as.factor(Hair_loss))) +
geom_bar(show.legend = FALSE) +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
scale_x_discrete(labels=c('No', 'Yes')) +
labs(title="Hair Loss(Y/N)", x ="Hair Loss(Yes or No)", y = "count") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
p7 <- pcos_data %>%
ggplot(aes(x = as.factor(Pimples), fill = as.factor(Pimples))) +
geom_bar(show.legend = FALSE) +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
scale_x_discrete(labels=c('No', 'Yes')) +
labs(title="Pimples(Y/N)", x ="Pimples(Yes or No)", y = "count") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
p8 <- pcos_data %>%
ggplot(aes(x = as.factor(Fast_food), fill = as.factor(Fast_food))) +
geom_bar(show.legend = FALSE) +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
scale_x_discrete(labels=c('No', 'Yes')) +
labs(title="Fast Food(Y/N)", x ="Fast Food(Yes or No)", y = "count") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
p9 <- pcos_data %>%
ggplot(aes(x = as.factor(Reg_Exercise), fill = as.factor(Reg_Exercise))) +
geom_bar(show.legend = FALSE) +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
scale_x_discrete(labels=c('No', 'Yes')) +
labs(title="Regularly Exercise(Y/N)", x ="Regular Exercise(Yes or No)", y = "count") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8,p9)
p_10 <- pcos_data %>%
ggplot(aes(x = as.factor(Blood_Group), fill = as.factor(Blood_Group))) +
geom_bar(show.legend = FALSE) +
geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
labs(title="Bllod Groups",
x ="Blood Groups", y = "count") +
scale_x_discrete(labels=c('A+', 'A-', 'B+', 'B-', 'O+', 'O-', 'AB+', 'AB-')) +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
p_11 <- pcos_data %>%
ggplot(aes(x = as.factor(`Age(yrs)`))) +
geom_histogram(stat="count", show.legend = FALSE, , fill = "#69b3a2", color = "#e9ecef", alpha=0.9) +
labs(title="Age range", x ="Age(yrs)", y = "count") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
p_12 <- pcos_data %>%
ggplot(aes(x = as.factor(`Weight(kg)`))) +
geom_histogram(stat="count", show.legend = FALSE, , fill = "#69b3a2", color = "#e9ecef", alpha=0.9) +
labs(title="Weight range", x ="Weight(kg)", y = "count") +
theme_ipsum() +
theme(
plot.title = element_text(size=10), axis.text.x = element_text(angle = 90, vjust = 1, hjust=2, size=5)
)
p_13 <- pcos_data %>%
ggplot(aes(x = as.factor(`Marriage_Status(yrs)`))) +
geom_histogram(stat="count", show.legend = FALSE, fill = "#69b3a2", color = "#e9ecef", alpha=0.9) +
labs(title="Years married range", x ="Married status(yrs)", y = "count") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
grid.arrange(p_10,p_11,p_12,p_13)
pcos_data %>%
ggplot(aes(x=`Age(yrs)`, y=`Cycle_length(days)`, color=as.factor(PCOS))) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Age(yrs)", y = "Cycle Length(days)") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x=`Age(yrs)`, y=`Cycle(R/I)`, color=as.factor(PCOS))) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Age(yrs)", y = "Cycle(R/I)") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x=`Age(yrs)`, y=BMI, color=as.factor(PCOS))) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Age(yrs)", y = "BMI") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x=`Follicle_No(R)`, y=`Follicle_No(L)`, color=as.factor(PCOS))) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Follicles Right", y = "Follicles Left") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x=`Avg_F_size(R)(mm)`, y=`Avg_F_size(L)(mm)`, color=as.factor(PCOS))) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Follicle size right", y = "Follicle size left") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x=`Endometrium(mm)`, y=`Cycle_length(days)`, color=as.factor(PCOS))) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
scale_colour_discrete("PCOS", labels = c("No",
"Yes")) +
labs(title="Title",
x ="Endometrium(mm)", y = "Cycle Length(days)") +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
pcos_data %>%
ggplot(aes(x = Blood_Group, fill = as.factor(PCOS))) +
geom_bar(position = "dodge") +
ggtitle("Blood Group with PCOS") +
scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
theme_ipsum() +
theme(
plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
)
pcos_data %>%
ggplot(aes(x = as.factor(Pregnant), fill = as.factor(PCOS))) +
geom_bar(position = "dodge") +
ggtitle("Pregnant with PCOS") +
scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
scale_x_discrete(labels=c('No', 'Yes')) +
theme_ipsum() +
theme(
plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
)
pcos_data %>%
ggplot(aes(x = `Cycle_length(days)`, fill = as.factor(PCOS))) +
geom_bar(position = "dodge") +
ggtitle("Cycle Length") +
scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
theme_ipsum() +
theme(
plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
)
pcos_data %>%
ggplot(aes(x = No_of_abortions, fill = as.factor(PCOS))) +
geom_bar(position = "dodge") +
ggtitle("title") +
scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
theme_ipsum() +
theme(
plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
)
pcos_data %>%
ggplot(aes(x = as.factor(`PRG(ng/mL)`))) +
geom_histogram(stat="count", show.legend = FALSE, , fill = "#69b3a2", color = "#e9ecef", alpha=0.9) +
labs(title="PRG range", x ="PRG(ng/mL)", y = "count") +
theme_ipsum() +
theme(
plot.title = element_text(size=10), axis.text.x = element_text(angle = 90, vjust = 1, hjust=2, size=5)
)
