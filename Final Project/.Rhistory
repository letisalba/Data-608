knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(corrplot)
library(DataExplorer)
library(hrbrthemes)
library(ggplot2)
library(rsconnect)
library(plotly)
library(shiny)
pcos <- read.csv("https://raw.githubusercontent.com/letisalba/DATA_608/master/Final%20Project/csv/PCOS_infertility.csv")
pcos_infertility <- read.csv("https://raw.githubusercontent.com/letisalba/DATA_608/master/Final%20Project/csv/PCOSData_without_infertility.csv")
head(pcos, 4)
head(pcos_infertility, 4)
glimpse(pcos)
glimpse(pcos_infertility)
DataExplorer::plot_histogram(
geom_histogram_args = list(alpha = 0.5, fill = "red"),
data = pcos,
ggtheme=theme_ipsum())
DataExplorer::plot_histogram(
geom_histogram_args = list(alpha = 0.5, fill = "purple"),
data = pcos_infertility,
ggtheme=theme_ipsum())
pcos <- mutate_all(pcos, function(x) as.numeric(as.character(x)))
pcos_infertility <- mutate_all(pcos_infertility, function(x) as.numeric(as.character(x)))
colnames(pcos)
colnames(pcos_infertility)
# removing first two column for `pcos` data
# pcos <- dplyr::select(pcos, -c(1:2))
pcos <- dplyr::select(pcos, -c(2))
# renaming columns for `pcos` data
pcos <- pcos %>%
rename("Sl.No" = "Sl..No",
"PCOS(Y/N)" = "PCOS..Y.N.",
"I beta-HCG(mIU/mL)" = "I...beta.HCG.mIU.mL.",
"II beta-HCG(mIU/mL)" = "II....beta.HCG.mIU.mL.",
"AMH(ng/mL)" = "AMH.ng.mL." )
# removing columns not needed for `pcos_infertility` data
#pcos_infertility <- dplyr::select(pcos_infertility, -c(1:2, 17:18, 26, 45))
pcos_infertility <- dplyr::select(pcos_infertility, -c(2, 17:18, 26, 45))
# renaming columns for `pcos_infertility` data
pcos_infertility <- pcos_infertility %>%
rename("Sl.No" = "Sl..No",
"PCOS(Y/N)" = "PCOS..Y.N.",
"Age(Yrs)" = "Age..yrs.",
"Weight(Kg)" = "Weight..Kg.",
"Height(Cm)" = "Height.Cm.",
"Blood Group" = "Blood.Group",
"Pulse rate(bpm)" = "Pulse.rate.bpm.",
"RR(breaths/min)" = "RR..breaths.min.",
"Hb(g/dl)" = "Hb.g.dl.",
"Cycle(R/I)" = "Cycle.R.I.",
"Cycle length(days)" = "Cycle.length.days.",
"Marriage Status(Yrs)" = "Marraige.Status..Yrs.",
"Pregnant(Y/N)" = "Pregnant.Y.N.",
"No. of aborptions" = "No..of.aborptions",
"FSH(mIU/mL)" = "FSH.mIU.mL.",
"LH(mIU/mL)" = "LH.mIU.mL.",
"FSH/LH" = "FSH.LH",
"Hip(inch)" = "Hip.inch.",
"Waist(inch)" = "Waist.inch.",
"Waist-Hip Ratio" = "Waist.Hip.Ratio",
"TSH(mIU/L)" = "TSH..mIU.L.",
"PRL(ng/mL)" = "PRL.ng.mL.",
"Vit D3(ng/mL)" = "Vit.D3..ng.mL.",
"PRG(ng/mL)" = "PRG.ng.mL.",
"RBS(mg/dl)" = "RBS.mg.dl.",
"Weight gain(Y/N)" = "Weight.gain.Y.N.",
"hair growth(Y/N)" = "hair.growth.Y.N.",
"Skin darkening(Y/N)" = "Skin.darkening..Y.N.",
"Hair loss(Y/N)" = "Hair.loss.Y.N.",
"Pimples(Y/N)" = "Pimples.Y.N.",
"Fast food(Y/N)" = "Fast.food..Y.N.",
"Reg.Exercise(Y/N)" = "Reg.Exercise.Y.N.",
"BP Systolic(mmHg)" = "BP._Systolic..mmHg.",
"BP Diastolic(mmHg)" = "BP._Diastolic..mmHg.",
"Follicle No.(L)" = "Follicle.No...L.",
"Follicle No.(R)" = "Follicle.No...R.",
"Avg. F size(L)(mm)" = "Avg..F.size..L...mm.",
"Avg. F size(R)(mm)" = "Avg..F.size..R...mm.",
"Endometrium(mm)" = "Endometrium..mm.")
# merge data sets
#pcos_data <- merge(pcos, pcos_infertility, by= "PCOS(Y/N)")
pcos_data <- merge(pcos, pcos_infertility,  by=c("Sl.No"))
#pcos_data <- pcos_data[,-6]
head(pcos_data)
# missing data
colSums(is.na(pcos_data))
# convert Height from cm to m
pcos_data$"Height(Cm)" <- round((pcos_data$"Height(Cm)" * 0.01),1)
pcos_data <- pcos_data %>%
rename("Height(M)" = "Height(Cm)")
# calculate BMI
pcos_data$BMI <- round((pcos_data$"Weight(Kg)" / pcos_data$"Height(M)"^2), 1)
# calculate waist-hip ratio
pcos_data$"Waist-Hip Ratio" <- round((pcos_data$"Waist(inch)" / pcos_data$"Hip(inch)"),2)
# calculate FSH/LH
pcos_data$"FSH/LH" <- round((pcos_data$"FSH(mIU/mL)"/pcos_data$"LH(mIU/mL)"),2)
# calculate Marriage Status
pcos_data$"Marriage Status(Yrs)"[is.na(pcos_data$"Marriage Status(Yrs)")] <- median(pcos_data$"Marriage Status(Yrs)", na.rm = T)
# calculate Fast food
pcos_data$"Fast food(Y/N)"[is.na(pcos_data$"Fast food(Y/N)")] <- median(pcos_data$"Fast food(Y/N)", na.rm = T)
# calculate
pcos_data$"AMH(ng/mL)"[is.na(pcos_data$"AMH(ng/mL)")] <- median(pcos_data$"AMH(ng/mL)", na.rm = T)
DataExplorer::plot_histogram(
geom_histogram_args = list(alpha = 0.5, fill = "dark green"),
data = pcos_data,
ggtheme=theme_ipsum())
colnames(pcos_data)
str(pcos_data)
#pcos_data$`AMH(ng/mL)` <- as.numeric(pcos_data$`AMH(ng/mL)`)
#str(pcos_data)
plot(x=pcos_data$'Age(Yrs)', y=pcos_data$'Weight(Kg)')
plot_ly(data = pcos_data, x = ~'Age(Yrs)', y = ~'Weight(Kg)')
ggplot(pcos_data, (aes(x='Age(Yrs)', y='Weight(Kg)'))) +
geom_point() +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
ggplot(pcos_data, aes(x=pcos_data$"Hip(inch)", y=pcos_data$"Waist(inch)")) +
geom_point() +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
# fig <- pcos_data %>%
#   plot_ly() %>%
#   add_trace(x = ~x, y = ~y, type = 'bar',
#              text = y, textposition = 'auto',
#              marker = list(color = 'rgb(158,202,225)',
#                            line = list(color = 'rgb(8,48,107)', width = 1.5))) %>%
#   add_trace(x = ~x, y = ~y2, type = 'bar',
#             text = y2, textposition = 'auto',
#             marker = list(color = 'rgb(58,200,225)',
#                           line = list(color = 'rgb(8,48,107)', width = 1.5))) %>%
#   layout(title = "January 2013 Sales Report",
#          barmode = 'group',
#          xaxis = list(title = ""),
#          yaxis = list(title = ""))
#
# fig
ggplot(pcos_data, (aes(x=Age(Yrs), y=Weight(Kg)))) +
geom_point() +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(corrplot)
library(DataExplorer)
library(hrbrthemes)
library(ggplot2)
library(rsconnect)
library(plotly)
library(shiny)
pcos <- read.csv("https://raw.githubusercontent.com/letisalba/DATA_608/master/Final%20Project/csv/PCOS_infertility.csv")
pcos_infertility <- read.csv("https://raw.githubusercontent.com/letisalba/DATA_608/master/Final%20Project/csv/PCOSData_without_infertility.csv")
head(pcos, 4)
head(pcos_infertility, 4)
glimpse(pcos)
glimpse(pcos_infertility)
DataExplorer::plot_histogram(
geom_histogram_args = list(alpha = 0.5, fill = "red"),
data = pcos,
ggtheme=theme_ipsum())
DataExplorer::plot_histogram(
geom_histogram_args = list(alpha = 0.5, fill = "purple"),
data = pcos_infertility,
ggtheme=theme_ipsum())
pcos <- mutate_all(pcos, function(x) as.numeric(as.character(x)))
pcos_infertility <- mutate_all(pcos_infertility, function(x) as.numeric(as.character(x)))
colnames(pcos)
colnames(pcos_infertility)
# removing first two column for `pcos` data
# pcos <- dplyr::select(pcos, -c(1:2))
pcos <- dplyr::select(pcos, -c(2))
# renaming columns for `pcos` data
pcos <- pcos %>%
rename("Sl.No" = "Sl..No",
"PCOS" = "PCOS..Y.N.",
"I_beta-HCG_mIUmL" = "I...beta.HCG.mIU.mL.",
"II_beta-HCG_mIUmL" = "II....beta.HCG.mIU.mL.",
"AMH_ngmL" = "AMH.ng.mL." )
# removing columns not needed for `pcos_infertility` data
#pcos_infertility <- dplyr::select(pcos_infertility, -c(1:2, 17:18, 26, 45))
pcos_infertility <- dplyr::select(pcos_infertility, -c(2, 17:18, 26, 45))
# renaming columns for `pcos_infertility` data
pcos_infertility <- pcos_infertility %>%
rename("Sl.No" = "Sl..No",
"PCOS" = "PCOS..Y.N.",
"Age_yrs" = "Age..yrs.",
"Weight_Kg" = "Weight..Kg.",
"Height_Cm" = "Height.Cm.",
"Blood_Group" = "Blood.Group",
"Pulse_rate_bpm" = "Pulse.rate.bpm.",
"RR_breaths-min" = "RR..breaths.min.",
"Hb_g-dl" = "Hb.g.dl.",
"Cycle_R-I" = "Cycle.R.I.",
"Cycle_length-days" = "Cycle.length.days.",
"Marriage_Status_Yrs" = "Marraige.Status..Yrs.",
"Pregnant" = "Pregnant.Y.N.",
"No_of_aborptions" = "No..of.aborptions",
"FSH_mIU-mL" = "FSH.mIU.mL.",
"LH_mIU-mL" = "LH.mIU.mL.",
"FSH-LH" = "FSH.LH",
"Hip_in" = "Hip.inch.",
"Waist_in" = "Waist.inch.",
"Waist-Hip_Ratio" = "Waist.Hip.Ratio",
"TSH_mIUL" = "TSH..mIU.L.",
"PRL_ng-mL" = "PRL.ng.mL.",
"Vit_D3_ng-mL" = "Vit.D3..ng.mL.",
"PRG_ng-mL" = "PRG.ng.mL.",
"RBS_mg-dl" = "RBS.mg.dl.",
"Weight_gain" = "Weight.gain.Y.N.",
"hair_growth" = "hair.growth.Y.N.",
"Skin_darkening" = "Skin.darkening..Y.N.",
"Hair_loss" = "Hair.loss.Y.N.",
"Pimples" = "Pimples.Y.N.",
"Fast_food" = "Fast.food..Y.N.",
"Reg_Exercise" = "Reg.Exercise.Y.N.",
"BP_Systolic_mmHg" = "BP._Systolic..mmHg.",
"BP_Diastolic_mmHg" = "BP._Diastolic..mmHg.",
"Follicle_No(L)" = "Follicle.No...L.",
"Follicle_No(R)" = "Follicle.No...R.",
"Avg_F_size_Lmm" = "Avg..F.size..L...mm.",
"Avg_F_size_Rmm" = "Avg..F.size..R...mm.",
"Endometrium_mm" = "Endometrium..mm.")
# merge data sets
#pcos_data <- merge(pcos, pcos_infertility, by= "PCOS(Y/N)")
pcos_data <- merge(pcos, pcos_infertility,  by=c("Sl.No"))
#pcos_data <- pcos_data[,-6]
head(pcos_data)
# missing data
colSums(is.na(pcos_data))
# convert Height from cm to m
pcos_data$"Height_Cm" <- round((pcos_data$"Height_Cm" * 0.01),1)
pcos_data <- pcos_data %>%
rename("Height_M" = "Height_Cm")
# calculate BMI
pcos_data$BMI <- round((pcos_data$"Weight_Kg" / pcos_data$"Height_M"^2), 1)
# calculate waist-hip ratio
pcos_data$"Waist-Hip_Ratio" <- round((pcos_data$"Waist_in" / pcos_data$"Hip_in"),2)
# calculate FSH/LH
pcos_data$"FSH-LH" <- round((pcos_data$"FSH_mIU-mL"/pcos_data$"LH_mIU-mL"),2)
# calculate Marriage Status
pcos_data$"Marriage_Status_Yrs"[is.na(pcos_data$"Marriage_Status_Yrs")] <- median(pcos_data$"Marriage_Status_Yrs", na.rm = T)
# calculate Fast food
pcos_data$"Fast_food"[is.na(pcos_data$"Fast_food")] <- median(pcos_data$"Fast_food", na.rm = T)
# calculate
pcos_data$"AMH_ngmL"[is.na(pcos_data$"AMH_ngmL")] <- median(pcos_data$"AMH_ngmL", na.rm = T)
DataExplorer::plot_histogram(
geom_histogram_args = list(alpha = 0.5, fill = "dark green"),
data = pcos_data,
ggtheme=theme_ipsum())
colnames(pcos_data)
str(pcos_data)
#pcos_data$`AMH(ng/mL)` <- as.numeric(pcos_data$`AMH(ng/mL)`)
#str(pcos_data)
#plot(x=pcos_data$'Age(Yrs)', y=pcos_data$'Weight(Kg)')
plot_ly(data = pcos_data, x = ~'Age(Yrs)', y = ~'Weight(Kg)')
ggplot(pcos_data, (aes(x=Age_Yrs, y=Weight_Kg))) +
geom_point() +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
ggplot(pcos_data, (aes(x=Age_Yrs, y=Weight_Kg))) +
geom_point() +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
ggplot2::ggplot(pcos_data, (aes(x=Age_Yrs, y=Weight_Kg))) +
geom_point() +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
update.packages(oldPkgs = "rlang")
?rlang
update.packages(c("rlang"))
ggplot2::ggplot(pcos_data, aes(x=Age_Yrs, y=Weight_Kg)) +
geom_point() +
theme_ipsum() +
theme(
plot.title = element_text(size=10)
)
