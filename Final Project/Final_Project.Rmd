---
title: "Data 608 - Final Project"
author: "Leticia Salazar"
date: "December 11, 2022"
output:
  html_document:
    theme: united
    highlight: kate
  html_notebook: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

$~$

# Polycystic Ovarian Syndrome (PCOS)

$~$

## Overview: 

Polycystic ovarian syndrome (PCOS) is a reproductive hormonal imbalance condition affecting as much as 5 million women in the US alone. It's believed that genetics and environmental factors can cause PCOS that affect their body physically and emotionally along with their metabolism, overall health and appearance in women. PCOS causes problems in ovaries making it hard for women to have a healthy menstrual cycle leading to the development of cysts and infertility. Although very common in women of reproductive age, PCOS may begin shortly after puberty but can also develop during the later teenage years and early adulthood.


$~$

Hormones that are involved in PCOS are:

* **Androgens: ** aka "male hormones" are present in women with PCOS at higher levels than usual. Excess in androgens can cause symptoms such as acne, unwanted hair, thinning hair, and irregular periods.

* **Insulin: ** allows the body to absorb glucose (blood sugar) into the cells for energy. In PCOS, the body doesn't respond to insulin as intended therefore, elevations in blood glucose levels can be assessed. Such elevations then lead to increased production of androgen.

* **Progesterone: ** vital hormone for menstruation and pregnancy; lack of progesterone contributes to irregular periods.

$~$

PCOS Symptoms:

Many of these symptoms can be attributed to other causes or go unnoticed but it is very common for PCOS to go undiagnosed for some time. Here are some symptoms that help with the diagnosis:

* **Irregular periods: ** irregular or missed periods as are a result of not ovulating is a common signs of PCOS

* **Polycystic ovaries: ** some may develop cysts in their ovaries but some don't. Ovaries may be enlarged and follicles surrounding their eggs therefore failing to function regularly.

* **Excess androgen: ** elevated levels of male hormones can cause excess hair and acne.

$~$

Other symptoms may include:

* **Weight gain: ** many people with PCOS will have weight gain or obesity that is difficult to manage.

* **Fatigue: ** increase in fatigue or low energy is also common

* **Unwanted hair growth: ** due to excess androgen, areas such as face, arms, back, chest, hand, toes and abdomen may have excess hair growth.

* **Thinning hair on the head: ** hair loss may increase in middle age for those with PCOS

* **Infertility: ** PCOS is a leading cause for infertility but not everyone is the same.

* **Acne: ** due to hormonal changes, acne can be arise and make skin oilier than usual and cause breakout in the face, chest and upper back.

* **Darkening of skin: ** areas such as under arms, breasts or back of your neck may get dark, patchy or thicken

* **Mood changes: ** mood swings, depression and anxiety can increase

* **Pelvic pain: ** pain may occur with periods along with heavy bleeding or without bleeding

* **Headaches: ** can occur due to hormonal changes

* **Sleep problems: ** most people often suffer with problem such as insomnia or poor sleep. These arise due to many factors but a common one is having sleep apnea (sleep disorder). Even when you fall asleep you wake up as if you have not slept at all or have trouble falling asleep.

* **Depression: ** can arise due to symptoms that can alter your appearance and have a negative impact on your emotions.

* **It's good to note that not everyone who is diagnosed with PCOS experiences all of these symptoms and should always consult with a their PCP or OBGYN to get an accurate diagnosis.** *

$~$

### Relevancy: 

Being diagnosed almost 2 years ago with PCOS I was intrigued to learn more and explore the data that was available. Although not much data was easily accessible this is a start to explore differences or similarities women share with their physical aspect and blood work. It's also important to be aware of symptoms experienced by PCOS because it's such symptoms that can always be misinterpreted as "too much stress" or "just lose weight" by doctors. After advocating for myself with multiple doctors over the span of 6 years I saw the true value in listening to your body and sharing my experience with others.

This project will consist of merging two csv files into one but before attempting to do this my main target are the missing values in the data set `pcos_infertility` such as `BMI`, `FSH.LH` and `Waist.Hip.Ratio`, renaming columns and ensuring the data sets are manageable. I will then be using the Shiny App to have interactive visualizations with Plotly to go through each category and define any patterns women from Indian with PCOS may have. Essentially we could use these commonalities to help women all over learn to distinguish symptoms not only by the physical aspects of PCOS but also during a routine lab work.

$~$

### Load Libraries:

These are the libraries used to explore, prepare and visualize the data
```{r, warning=FALSE, message=FALSE}
library(tidyverse)
library(dplyr)
library(DataExplorer)
library(hrbrthemes)
library(ggplot2)
library(gridExtra)
```

$~$

### Load data:


#### Description:
Below is a short description of the variables of interest in the data sets:

* The data sets I will be using are from [Kaggle](https://www.kaggle.com/datasets/prasoonkottarathil/polycystic-ovary-syndrome-pcos) collected from 10 different hospital across Kerala, India:


Things to consider and understand the data set:

* Units used are feet to cm
* For Yes | No questions
  * Yes = 1
  * No = 0
* Blood Groups:
  * A+ = 11
  * A- = 12
  * B+ = 13
  * B- = 14
  * O+ = 15
  * O- = 16
  * AB+ = 17
  * AB- = 18
* RBS means Random glucose test
* PRG means PCOS related genes
* Blood pressure entered as systolic and diastolic separately
* Beta-HCG cases are mentioned as Case I and II.
* "Cycle(R/I)" values are as follows:
  * 4 indicates irregular menstrual cycle
  * 2 indicates a regular menstrual cycle

$~$

I have included the original data sets in my [GitHub](https://github.com/letisalba/Data_608/tree/master/Final%20Project/csv) account and read from this location. 
```{r, echo=FALSE}
pcos <- read.csv("https://raw.githubusercontent.com/letisalba/DATA_608/master/Final%20Project/csv/PCOS_infertility.csv")
pcos_infertility <- read.csv("https://raw.githubusercontent.com/letisalba/DATA_608/master/Final%20Project/csv/PCOSData_without_infertility.csv")
```


Lets view the `pcos` data:
```{r, echo=FALSE}
head(pcos, 4)
```

... And the `pcos_infertility` data:
```{r, echo=FALSE}
head(pcos_infertility, 4)
```

$~$

### Data Exploration:

The first data set `pcos` includes 541 observations and a total of 6 variables. The second data set `pcos_infertility` includes 541 observations and a total of 45 variables. Notice that the column names are not clear enough for readers, this will be tackled in the data preparation section.

```{r, echo=FALSE}
glimpse(pcos)
```

```{r, echo=FALSE}
glimpse(pcos_infertility)
```

$~$

Let's look at the distribution of our data sets using histograms:

`pcos` data:
```{r, fig.height = 10, fig.width = 10, echo=FALSE, fig.align='center', warning=FALSE, message=FALSE}
DataExplorer::plot_histogram(
  geom_histogram_args = list(alpha = 0.5, fill = "red"),
   data = pcos,
         ggtheme=theme_ipsum())
```

$~$

`pcos_infertility` data:
```{r, fig.height = 10, fig.width = 10, echo=FALSE, fig.align='center'}
DataExplorer::plot_histogram(
  geom_histogram_args = list(alpha = 0.5, fill = "purple"),
   data = pcos_infertility,
         ggtheme=theme_ipsum())
```


$~$

### Data Preparation:

Before I start the tidying process I converted the data sets as numeric since the class of some of the variables differ. 
```{r, echo=FALSE, warning=FALSE}
pcos <- mutate_all(pcos, function(x) as.numeric(as.character(x)))
pcos_infertility <- mutate_all(pcos_infertility, function(x) as.numeric(as.character(x)))
```

$~$

Lets look at the column names of both data sets to be able to start tidying the data:

pcos:
```{r, echo=FALSE}
colnames(pcos)
```

$~$

pcos_infertility:
```{r,echo=FALSE}
colnames(pcos_infertility)
```

$~$

As mentioned earlier, my data preparation will mainly consist of renaming columns, targeting missing values whether it is by replacing them with a mean, median or mode for `Marriage Status (Yrs)` and `Fast Food (Y/N)` or calculating the values as a whole as its the case of `BMI`, `FSH.LH` and `Waist.Hip.Ratio`. I'll also remove columns that are duplicate or not need so that it's easier to manage when I merge my two data sets.

```{r, echo=FALSE}
# removing first two column for `pcos` data
# pcos <- dplyr::select(pcos, -c(1:2)) 
pcos <- dplyr::select(pcos, -c(2))

# renaming columns for `pcos` data
pcos <- pcos %>% 
  rename("Sl.No" = "Sl..No",
         "PCOS" = "PCOS..Y.N.",
         "Ibeta-HCG(mIU/mL)" = "I...beta.HCG.mIU.mL.",
         "IIbeta-HCG(mIU/mL)" = "II....beta.HCG.mIU.mL.",
         "AMH(ng/mL)" = "AMH.ng.mL." )

# removing columns not needed for `pcos_infertility` data
#pcos_infertility <- dplyr::select(pcos_infertility, -c(1:2, 17:18, 26, 45))
pcos_infertility <- dplyr::select(pcos_infertility, -c(2:3, 17:18, 26, 45))

# renaming columns for `pcos_infertility` data
pcos_infertility <- pcos_infertility %>% 
  rename("Sl.No" = "Sl..No",
         "Age(yrs)" = "Age..yrs.",
         "Weight(kg)" = "Weight..Kg.",
         "Height(cm)" = "Height.Cm.",
         "Blood_Group" = "Blood.Group", 
         "Pulse rate(bpm)" = "Pulse.rate.bpm.",
         "RR(breaths/min)" = "RR..breaths.min.",
         "Hb(g/dl)" = "Hb.g.dl.",
         "Cycle(R/I)" = "Cycle.R.I.",
         "Cycle_length(days)" = "Cycle.length.days.",
         "Marriage_Status(yrs)" = "Marraige.Status..Yrs.",
         "Pregnant" = "Pregnant.Y.N.",
         "No_of_abortions" = "No..of.aborptions",
         "FSH(mIU/mL)" = "FSH.mIU.mL.",
         "LH(mIU/mL)" = "LH.mIU.mL.",
         "FSH-LH" = "FSH.LH",
         "Hip(in)" = "Hip.inch.",
         "Waist(in)" = "Waist.inch.",
         "Waist-Hip_Ratio" = "Waist.Hip.Ratio",
         "TSH (mIU/L)" = "TSH..mIU.L.",
         "PRL(ng/mL)" = "PRL.ng.mL.",
         "Vit_D3(ng/mL)" = "Vit.D3..ng.mL.",
         "PRG(ng/mL)" = "PRG.ng.mL.",
         "RBS(mg/dl)" = "RBS.mg.dl.",
         "Weight_gain" = "Weight.gain.Y.N.",
         "hair_growth" = "hair.growth.Y.N.",
         "Skin_darkening" = "Skin.darkening..Y.N.",
         "Hair_loss" = "Hair.loss.Y.N.",
         "Pimples" = "Pimples.Y.N.",
         "Fast_food" = "Fast.food..Y.N.",
         "Reg_Exercise" = "Reg.Exercise.Y.N.",
         "BP_Systolic(mmHg)" = "BP._Systolic..mmHg.",
         "BP_Diastolic(mmHg)" = "BP._Diastolic..mmHg.",
         "Follicle_No(L)" = "Follicle.No...L.",
         "Follicle_No(R)" = "Follicle.No...R.",
         "Avg_F_size(L)(mm)" = "Avg..F.size..L...mm.",
         "Avg_F_size(R)(mm)" = "Avg..F.size..R...mm.",
         "Endometrium(mm)" = "Endometrium..mm.")
```
$~$

Here's the results after part 1 of the preparation process:
```{r, echo=FALSE}
# merge data sets
pcos_data <- merge(pcos, pcos_infertility,  by=c("Sl.No"))
head(pcos_data)
```

$~$

Checking for missing data:
```{r, echo=FALSE}
# missing data
colSums(is.na(pcos_data))
```
$~$

For part 2, I tackled the missing values by first transforming `Height` from cm to m, calculate `BMI`, `Waist-hip ratio`  and `FSH/LH`. Then after careful consideration to the data, I decided to use the median number to replace the missing values in `Marriage_Status(yrs)`, `AMH(ng/mL)` and `Fast_food` since it didn't disrupt the data's distribution.
```{r, echo=FALSE, warning=FALSE}
# convert Height from cm to m
pcos_data$"Height(cm)" <- round((pcos_data$"Height(cm)" * 0.01),1)

pcos_data <- pcos_data %>% 
  rename("Height(m)" = "Height(cm)")

# calculate BMI
pcos_data$BMI <- round((pcos_data$"Weight(kg)" / pcos_data$"Height(m)"^2), 1)

# calculate waist-hip ratio
pcos_data$"Waist-Hip_Ratio" <- round((pcos_data$"Waist(in)" / pcos_data$"Hip(in)"),2)

# calculate FSH/LH
pcos_data$"FSH-LH" <- round((pcos_data$"FSH(mIU/mL)"/pcos_data$"LH(mIU/mL)"),2)

# calculate Marriage Status
pcos_data$"Marriage_Status(yrs)"[is.na(pcos_data$"Marriage_Status(yrs)")] <- median(pcos_data$"Marriage_Status(yrs)", na.rm = T)

# calculate Fast food
pcos_data$"Fast_food"[is.na(pcos_data$"Fast_food")] <- median(pcos_data$"Fast_food", na.rm = T)

# calculate 
pcos_data$"AMH(ng/mL)"[is.na(pcos_data$"AMH(ng/mL)")] <- median(pcos_data$"AMH(ng/mL)", na.rm = T)
```

$~$

After tidying up the data, below is the final distribution:
```{r, fig.height = 10, fig.width = 10, echo=FALSE, fig.align='center'}
DataExplorer::plot_histogram(
  geom_histogram_args = list(alpha = 0.5, fill = "dark green"),
   data = pcos_data,
         ggtheme=theme_ipsum())
```


```{r, echo=FALSE, eval=FALSE}
colnames(pcos_data)
```

```{r, echo=FALSE, eval=FALSE}
str(pcos_data)
```


```{r}
#DataExplorer::create_report(pcos_data, output_file='pcos_data.html')
```


$~$

### Plots:

Now that the data is ready, I have created some plots to better understand the relationship of each variable.


* The scatter plot below shows the relationship between Age(yrs) and Weight(kg). It appears that the age and weight of the women are distributed evenly throughout as opposed to being clustered in a certain age and weight group.
```{r, warning=FALSE, echo=FALSE}
ggplot(pcos_data, aes(x=pcos_data$'Age(yrs)', y=pcos_data$'Weight(kg)')) + 
    geom_point() +
  labs(title="Scatterplot of Age(yrs) with Weight(kg)",
        x ="Age(yrs)", y = "Weight(kg)") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )
```
$~$

Statistics based on the plots below:

* 32.72% reported to have PCOS

* 38.08% of women reported to being pregnant

* 37.71% reported to experience weight gain

* 27.36% reported to experience hair growth

* 30.68% experience skin darkening

* 45.29% reported to experience hair loss

* 48.98% reported to experience pimples

* 51.57% reported to have fast food

* 24.77% reported to exercise regularly

```{r, fig.height=10, fig.width=10, echo=FALSE}
p1 <- pcos_data %>% 
  ggplot(aes(x = as.factor(PCOS), fill = as.factor(PCOS))) +
    geom_bar(show.legend = FALSE) + 
    geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
    scale_x_discrete(labels=c('No', 'Yes')) +
    labs(title="PCOS(Y/N)", x ="PCOS(Yes or No)", y = "count") +
   theme_ipsum() +
      theme(
        plot.title = element_text(size=10)
      )

p2 <- pcos_data %>% 
  ggplot(aes(x = as.factor(Pregnant), fill = as.factor(Pregnant))) +
    geom_bar(show.legend = FALSE) + 
    geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
    scale_x_discrete(labels=c('No', 'Yes')) +
    labs(title="Pregnant(Y/N)", x ="Pregnant(Yes or No)", y = "count") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

p3 <- pcos_data %>% 
  ggplot(aes(x = as.factor(Weight_gain), fill = as.factor(Weight_gain))) +
    geom_bar(show.legend = FALSE) + 
  geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
  scale_x_discrete(labels=c('No', 'Yes')) +
  labs(title="Weight Gain(Y/N)", x ="Weight Gain (Yes or No)", y = "count") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

p4 <- pcos_data %>% 
  ggplot(aes(x = as.factor(hair_growth), fill = as.factor(hair_growth))) +
    geom_bar(show.legend = FALSE) + 
  geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
  scale_x_discrete(labels=c('No', 'Yes')) +
  labs(title="Hair Growth(Y/N)", x ="Hair Growth(Yes or No)", y = "count") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

p5 <- pcos_data %>% 
  ggplot(aes(x = as.factor(Skin_darkening), fill = as.factor(Skin_darkening))) +
    geom_bar(show.legend = FALSE) + 
  geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
  scale_x_discrete(labels=c('No', 'Yes')) +
  labs(title="Skin Darkening(Y/N)", x ="Skin Darkening (Yes or No)", y = "count") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

p6 <- pcos_data %>% 
  ggplot(aes(x = as.factor(Hair_loss), fill = as.factor(Hair_loss))) +
    geom_bar(show.legend = FALSE) + 
  geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
  scale_x_discrete(labels=c('No', 'Yes')) +
  labs(title="Hair Loss(Y/N)", x ="Hair Loss(Yes or No)", y = "count") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

p7 <- pcos_data %>% 
  ggplot(aes(x = as.factor(Pimples), fill = as.factor(Pimples))) +
    geom_bar(show.legend = FALSE) + 
  geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
  scale_x_discrete(labels=c('No', 'Yes')) +
  labs(title="Pimples(Y/N)", x ="Pimples(Yes or No)", y = "count") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

p8 <- pcos_data %>% 
  ggplot(aes(x = as.factor(Fast_food), fill = as.factor(Fast_food))) +
    geom_bar(show.legend = FALSE) + 
  geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
  scale_x_discrete(labels=c('No', 'Yes')) +
  labs(title="Fast Food(Y/N)", x ="Fast Food(Yes or No)", y = "count") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

p9 <- pcos_data %>% 
  ggplot(aes(x = as.factor(Reg_Exercise), fill = as.factor(Reg_Exercise))) +
    geom_bar(show.legend = FALSE) + 
  geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
  scale_x_discrete(labels=c('No', 'Yes')) +
  labs(title="Regularly Exercise(Y/N)", x ="Regular Exercise(Yes or No)", y = "count") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8,p9)
```


$~$

Based on these next few plots:

* Majority of the women in this study have the blood type of O+, B+ and A+

* There is a wide range of distribution between the age of these women most falling between 23 to 38 years old.

* Similarly, weight also has a wide range of distribution

* The distribution of years married also varies where majority of the women fall between the first 10 years 

```{r, echo=FALSE, warning=FALSE, fig.height=10, fig.width=10}
p_10 <- pcos_data %>% 
  ggplot(aes(x = as.factor(Blood_Group), fill = as.factor(Blood_Group))) +
    geom_bar(show.legend = FALSE) +
  geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "black") +
  labs(title="Bllod Groups",
        x ="Blood Groups", y = "count") +
  scale_x_discrete(labels=c('A+', 'A-', 'B+', 'B-', 'O+', 'O-', 'AB+', 'AB-')) +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

p_11 <- pcos_data %>% 
  ggplot(aes(x = as.factor(`Age(yrs)`))) +
    geom_histogram(stat="count", show.legend = FALSE, , fill = "#69b3a2", color = "#e9ecef", alpha=0.9) +
  labs(title="Age range", x ="Age(yrs)", y = "count") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

p_12 <- pcos_data %>% 
  ggplot(aes(x = as.factor(`Weight(kg)`))) +
    geom_histogram(stat="count", show.legend = FALSE, , fill = "#69b3a2", color = "#e9ecef", alpha=0.9) +
  labs(title="Weight range", x ="Weight(kg)", y = "count") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10), axis.text.x = element_text(angle = 90, vjust = 1, hjust=2, size=5)
    )

p_13 <- pcos_data %>% 
  ggplot(aes(x = as.factor(`Marriage_Status(yrs)`))) +
    geom_histogram(stat="count", show.legend = FALSE, fill = "#69b3a2", color = "#e9ecef", alpha=0.9) +
  labs(title="Years married range", x ="Married status(yrs)", y = "count") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

grid.arrange(p_10,p_11,p_12,p_13)
```

$~$

* Cycle length seems to be very consistent regardless of PCOS diagnosis

* Women with PCOS (blue) experience more irregular periods with a few with no PCOS(coral) do as well

* With or without PCOS women's BMI fluctuate

* The distribution of number of follicles is greater for those women with without PCOS.

* The distribution of number of size in follicles left or right differ for those with and without PCOS

* The endometrium is the inner layer. During a woman's menstrual cycle, hormones cause the endometrium to change. Estrogen causes the endometrium to thicken so that it could nourish an embryo if pregnancy occurs.

```{r, echo=FALSE, warning=FALSE, fig.height=10, fig.width=10}
p14 <- pcos_data %>% 
ggplot(aes(x=`Age(yrs)`, y=`Cycle_length(days)`, color=as.factor(PCOS))) + 
    geom_point() +
    geom_smooth(method="lm", se=FALSE) +
    scale_colour_discrete("PCOS", labels = c("No", 
    "Yes")) +
  labs(title="Length of cycle based on Age",
        x ="Age(yrs)", y = "Cycle Length(days)") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

p15 <- pcos_data %>% 
ggplot(aes(x=`Age(yrs)`, y=`Cycle(R/I)`, color=as.factor(PCOS))) + 
    geom_point() +
    geom_smooth(method="lm", se=FALSE) +
    scale_colour_discrete("PCOS", labels = c("No", 
    "Yes")) +
  labs(title="Type of cycle based on Age",
        x ="Age(yrs)", y = "Cycle(R/I)") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

p16 <- pcos_data %>% 
ggplot(aes(x=`Age(yrs)`, y=BMI, color=as.factor(PCOS))) + 
    geom_point() +
    geom_smooth(method="lm", se=FALSE) +
    scale_colour_discrete("PCOS", labels = c("No", 
    "Yes")) +
  labs(title="BMI based on Age",
        x ="Age(yrs)", y = "BMI") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

p17 <- pcos_data %>% 
ggplot(aes(x=`Follicle_No(R)`, y=`Follicle_No(L)`, color=as.factor(PCOS))) + 
    geom_point() +
    geom_smooth(method="lm", se=FALSE) +
    scale_colour_discrete("PCOS", labels = c("No", 
    "Yes")) +
  labs(title="Number of Follicles",
        x ="Follicles Right", y = "Follicles Left") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

p18 <- pcos_data %>% 
ggplot(aes(x=`Avg_F_size(R)(mm)`, y=`Avg_F_size(L)(mm)`, color=as.factor(PCOS))) + 
    geom_point() +
    geom_smooth(method="lm", se=FALSE) +
    scale_colour_discrete("PCOS", labels = c("No", 
    "Yes")) +
  labs(title="Follicle size's",
        x ="Follicle size right", y = "Follicle size left") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )

p19 <- pcos_data %>% 
ggplot(aes(x=`Endometrium(mm)`, y=`Cycle_length(days)`, color=as.factor(PCOS))) + 
    geom_point() +
    geom_smooth(method="lm", se=FALSE) +
    scale_colour_discrete("PCOS", labels = c("No", 
    "Yes")) +
  labs(title="Endometrium and length of cycle(days)",
        x ="Endometrium(mm)", y = "Cycle Length(days)") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10)
    )


grid.arrange(p14,p15,p16,p17,p18,p19)
```




* Women with blood type of A+, B+, and O+ reported to have PCOS more than those with blood types of A-, B-, O-, AB+ and AB-
```{r, echo=FALSE, warning=FALSE}
pcos_data %>% 
  ggplot(aes(x = Blood_Group, fill = as.factor(PCOS))) +
    geom_bar(position = "dodge") +
  geom_text(aes(label = ..count..), position = position_dodge(width = 1), stat = "count", vjust = 1.5, colour = "black") +
    ggtitle("Blood Group with PCOS") +
    scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
    theme_ipsum() +
    theme(
      plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
    )

```

* Being that PCOS and infertility are linked, there are only 64 women with PCOS who are pregnant and 113 women with PCOS who aren't pregnant
```{r, echo=FALSE, warning=FALSE}
pcos_data %>% 
  ggplot(aes(x = as.factor(Pregnant), fill = as.factor(PCOS))) +
    geom_bar(position = "dodge") +
  geom_text(aes(label = ..count..), position = position_dodge(width = 1), stat = "count", vjust = 1.5, colour = "black") +
    ggtitle("Pregnant with PCOS") +
    scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
    scale_x_discrete(labels=c('No', 'Yes')) +
    theme_ipsum() +
    theme(
      plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
    )
```

```{r}
pcos_data %>%
  ggplot(aes(x = as.factor(Weight_gain), fill = as.factor(PCOS))) +
    geom_bar(position = "dodge") +
  geom_text(aes(label = ..count..), position = position_dodge(width = 1), stat = "count", vjust = 1.5, colour = "black") +
    ggtitle("Pregnant with PCOS") +
    scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
    scale_x_discrete(labels=c('No','Yes')) +
    theme_ipsum() +
    theme(
      plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
    )
```

```{r}
pcos_data %>%
  ggplot(aes(x = as.factor(hair_growth), fill = as.factor(PCOS))) +
    geom_bar(position = "dodge") +
  geom_text(aes(label = ..count..), position = position_dodge(width = 1), stat = "count", vjust = 1.5, colour = "black") +
    ggtitle("Pregnant with PCOS") +
    scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
    scale_x_discrete(labels=c('No','Yes')) +
    theme_ipsum() +
    theme(
      plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
    )
```

```{r}
pcos_data %>%
  ggplot(aes(x = as.factor(Skin_darkening), fill = as.factor(PCOS))) +
    geom_bar(position = "dodge") +
  geom_text(aes(label = ..count..), position = position_dodge(width = 1), stat = "count", vjust = 1.5, colour = "black") +
    ggtitle("Pregnant with PCOS") +
    scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
    scale_x_discrete(labels=c('No','Yes')) +
    theme_ipsum() +
    theme(
      plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
    )
```

```{r}
pcos_data %>%
  ggplot(aes(x = as.factor(Hair_loss), fill = as.factor(PCOS))) +
    geom_bar(position = "dodge") +
  geom_text(aes(label = ..count..), position = position_dodge(width = 1), stat = "count", vjust = 1.5, colour = "black") +
    ggtitle("Pregnant with PCOS") +
    scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
    scale_x_discrete(labels=c('No','Yes')) +
    theme_ipsum() +
    theme(
      plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
    )
```


```{r}
pcos_data %>%
  ggplot(aes(x = as.factor(Pimples), fill = as.factor(PCOS))) +
    geom_bar(position = "dodge") +
  geom_text(aes(label = ..count..), position = position_dodge(width = 1), stat = "count", vjust = 1.5, colour = "black") +
    ggtitle("Pregnant with PCOS") +
    scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
    scale_x_discrete(labels=c('No','Yes')) +
    theme_ipsum() +
    theme(
      plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
    )
```

```{r}
pcos_data %>%
  ggplot(aes(x = as.factor(Fast_food), fill = as.factor(PCOS))) +
    geom_bar(position = "dodge") +
  geom_text(aes(label = ..count..), position = position_dodge(width = 1), stat = "count", vjust = 1.5, colour = "black") +
    ggtitle("Pregnant with PCOS") +
    scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
    scale_x_discrete(labels=c('No','Yes')) +
    theme_ipsum() +
    theme(
      plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
    )
```

```{r}
pcos_data %>%
  ggplot(aes(x = as.factor(Reg_Exercise), fill = as.factor(PCOS))) +
    geom_bar(position = "dodge") +
    geom_text(aes(label = ..count..), position = position_dodge(width = 1), stat = "count", vjust = 1.5, colour = "black") +
    ggtitle("Pregnant with PCOS") +
    scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
    scale_x_discrete(labels=c('No','Yes')) +
    theme_ipsum() +
    theme(
      plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
    )
```



* Not surprised to see how fluctuated the cycle length is especially for women without PCOS since they tend to have a more regular cycle.
```{r, echo=FALSE, warning=FALSE}
pcos_data %>% 
  ggplot(aes(x = `Cycle_length(days)`, fill = as.factor(PCOS))) +
    geom_bar(position = "dodge") +
    geom_text(aes(label = ..count..), position = position_dodge(width = 1), stat = "count", vjust = 1.5, colour = "black") +
    ggtitle("Cycle Length") +
    scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
    theme_ipsum() +
    theme(
      plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
    )
```

* Sadly, abortions also plays a part in PCOS for women trying to conceive. I am however happy to see that the number isn't as great for women with PCOS
```{r, echo=FALSE, warning=FALSE}
pcos_data %>% 
  ggplot(aes(x = No_of_abortions, fill = as.factor(PCOS))) +
    geom_bar(position = "dodge") +
    ggtitle("title") +
    scale_fill_discrete(name = "PCOS", labels = c("No", "Yes")) +
    theme_ipsum() +
    theme(
      plot.title = element_text(size=10), axis.text.x = element_text(angle = 45)
    )
```

* I looked into PCOS related genes 
```{r, echo=FALSE, warning=FALSE, fig.height=10, fig.width=10}
 pcos_data %>% 
  ggplot(aes(x = as.factor(`PRG(ng/mL)`))) +
  geom_histogram(stat="count", show.legend = FALSE, , fill = "#69b3a2", color = "#e9ecef", alpha=0.9) +
  labs(title="PRG range", x ="PRG(ng/mL)", y = "count") +
  theme_ipsum() +
    theme(
      plot.title = element_text(size=10), axis.text.x = element_text(angle = 90, vjust = 1, hjust=2, size=5)
    )
```

$~$


```{r shiny app, eval=FALSE}

```


$~$

## References:

* Kottarathil, P. (2020, October 11). Polycystic ovary syndrome (PCOS). Kaggle. Retrieved October 9, 2022, from https://www.kaggle.com/datasets/prasoonkottarathil/polycystic-ovary-syndrome-pcos 

* Stewart, M. M., &amp; Foster, S. (2012). PCOS awareness association. PCOS Awareness Association. Retrieved October 9, 2022, from https://www.pcosaa.org/ 

* Bartlett, E., &amp; Erlich, L. (2015). Feed your fertility: Your guide to cultivating a healthy pregnancy with traditional Chinese medicine, real food, and holistic living. Fair Winds Press.

 